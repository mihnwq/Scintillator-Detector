//
// ********************************************************************
// * License and Disclaimer                                           *
// *                                                                  *
// * The  Geant4 software  is  copyright of the Copyright Holders  of *
// * the Geant4 Collaboration.  It is provided  under  the terms  and *
// * conditions of the Geant4 Software License,  included in the file *
// * LICENSE and available at  http://cern.ch/geant4/license .  These *
// * include a list of copyright holders.                             *
// *                                                                  *
// * Neither the authors of this software system, nor their employing *
// * institutes,nor the agencies providing financial support for this *
// * work  make  any representation or  warranty, express or implied, *
// * regarding  this  software system or assume any liability for its *
// * use.  Please see the license in the file  LICENSE  and URL above *
// * for the full disclaimer and the limitation of liability.         *
// *                                                                  *
// * This  code  implementation is the result of  the  scientific and *
// * technical work of the GEANT4 collaboration.                      *
// * By using,  copying,  modifying or  distributing the software (or *
// * any work based  on the software)  you  agree  to acknowledge its *
// * use  in  resulting  scientific  publications,  and indicate your *
// * acceptance of all terms of the Geant4 Software license.          *
// ********************************************************************
//
//
/// \file B4/B4a/src/DetectorConstruction.cc
/// \brief Implementation of the B4::DetectorConstruction class

#include "DetectorConstruction.hh"

#include "G4AutoDelete.hh"
#include "G4Box.hh"
#include "G4Colour.hh"
#include "G4GlobalMagFieldMessenger.hh"
#include "G4LogicalVolume.hh"
#include "G4Material.hh"
#include "G4NistManager.hh"
#include "G4PVPlacement.hh"
#include "G4PVReplica.hh"
#include "G4PhysicalConstants.hh"
#include "G4SystemOfUnits.hh"
#include "G4VisAttributes.hh"
#include <vector>
#include <G4SDManager.hh>

#include "DataVector.hh"


namespace B4
{

//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......

//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......

DetectorConstruction::DetectorConstruction()
 : nCols(10), nRows(10),
   isCherenkov(false), isScintillator(false), isCell(true),
   xWorld(3*m), yWorld(2*m), zWorld(3*m)
{
    fMessenger = new G4GenericMessenger(this, "/detector/", "Detector Construction");
    fMessenger->DeclareProperty("nCols", nCols, "Number of columns");
    fMessenger->DeclareProperty("nRows", nRows, "Number of rows");
    fMessenger->DeclareProperty("cherenkov", isCherenkov, "Construct Cherenkov detector");
    fMessenger->DeclareProperty("scintillator", isScintillator, "Construct Scintillator");
    

    DefineMaterials();
}

DetectorConstruction::~DetectorConstruction()
{
  // G4GenericMessenger deletes itself
}

//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......

void Sort(G4double vect[], int dim)
{
  for(int i = 0; i < dim - 1; i++)
  {
    for(int j = i + 1; j < dim; j++)
    {
       if(vect[i] > vect[j])
          {
          G4double aux = vect[i];
          vect[i] = vect[j];
          vect[j] = aux;
          }
    }
  }
}

void STD_Vector_Sort(std::vector<G4double> vect) {
    std::sort(vect.begin(), vect.end(),
                [](const G4double& a, const    G4double& b) {
                    return a>b;
                });

}

void DetectorConstruction::DefineMaterials()
{
 G4NistManager* nist = G4NistManager::Instance();

    worldMat = nist->FindOrBuildMaterial("G4_AIR");

    polystyrene = new G4Material("polystyrene", 1.06*g/cm3, 2);
    polystyrene->AddElement(nist->FindOrBuildElement("H"), 8);
    polystyrene->AddElement(nist->FindOrBuildElement("C"), 8);

    PMMA = new G4Material("PMMA", 1.29*g/cm3, 3);
    PMMA->AddElement(nist->FindOrBuildElement("H"), 8);
    PMMA->AddElement(nist->FindOrBuildElement("C"), 5);
    PMMA->AddElement(nist->FindOrBuildElement("O"), 2);

    TiO2 = new G4Material("TiO2", 4.23*g/cm3, 2);
    TiO2->AddElement(nist->FindOrBuildElement("Ti"), 1);
    TiO2->AddElement(nist->FindOrBuildElement("O"), 2);

    WLS_Core = new G4Material("WLS_Core", 1.06*g/cm3, 2);
    WLS_Core->AddElement(nist->FindOrBuildElement("H"), 8);
    WLS_Core->AddElement(nist->FindOrBuildElement("C"), 8);

   /* DataVector data_vector;

    data_vector.LoadFromFile("energyWLS_ABS.txt",',');

    G4int energyWLS_ABS_Length = data_vector.GetLength();

    G4double *energyWLS_ABS = data_vector.GetVector();*/

    G4double energyWLS_ABS[139] =

    {3.53141447226153*eV, 3.50599370592341*eV, 3.47676823387695*eV, 3.45210962834772*eV, 3.42776728850488*eV, 3.40771458544719
*eV, 3.38199115814024*eV, 3.36052314021254*eV, 3.34311174412659*eV, 3.32775645617612*eV, 3.31065311812161*eV, 3.29376769081901*eV, 3.28252543155232
*eV, 3.26770631952513*eV, 3.25304837236435*eV, 3.23140983920877*eV, 3.22240305139523*eV, 3.20816143239793*eV, 3.19399122764717*eV, 3.18520494361024
*eV, 3.17646686697261*eV, 3.17116993108669*eV, 3.16417886248164*eV, 3.15378928907116*eV, 2.93230375571202*eV, 2.93974855993499*eV, 2.92505481603788
*eV, 2.91931970202308*eV, 2.94428859146391*eV, 3.08608072158968*eV, 2.76807692892092*eV, 2.66119891672448*eV, 2.64796267233841*eV, 2.63842122403175
*eV, 2.67088727286469*eV, 2.67573430401643*eV, 2.68058946579435*eV, 2.6854432226491*eV, 2.69153280021055*eV, 2.69518446536062*eV, 2.69885567612614
*eV, 2.7025272520916*eV, 2.70616045179074*eV, 2.71104907308039*eV, 2.71470523738491*eV, 3.03973036955099*eV, 3.0524390070252*eV, 3.06194753447376
*eV, 3.07637193660979*eV, 3.03181981674717*eV, 3.03017713291647*eV, 3.02695762702358*eV, 3.09430264404961*eV, 3.09932031568586*eV, 3.10597643067659
*eV, 3.11269959986843*eV, 3.12111564343805*eV, 3.12789165783907*eV, 3.13308379173921*eV, 3.14161057580622*eV, 3.14683530945919*eV, 2.86274490861469
*eV, 2.85294326657347*eV, 2.87111761404776*eV, 2.84729436277603*eV, 2.84305899405101*eV, 2.83471087749478*eV, 2.82912329858336*eV, 2.82223812708419
*eV, 2.87382847473529*eV, 2.87795909298719*eV, 2.8821125772271*eV, 2.88626706086827*eV, 3.02215927620491*eV, 3.01735205585085*eV, 3.01257209536896
*eV, 3.00781920842495*eV, 2.94736898690765*eV, 2.95491365622554*eV, 2.96105603059472*eV, 2.96567378546982*eV, 2.97180267823937*eV, 2.97796867253551
*eV, 2.98417207271106*eV, 2.98732474179376*eV, 2.99200120137414*eV, 2.99518229616421*eV, 2.99989529859615*eV, 3.00306937952068*eV, 2.91649990394446
*eV, 2.91374163227606*eV, 2.9124485030179*eV, 2.90967551385031*eV, 2.90694129404114*eV, 2.90273825631888*eV, 2.89858065665948*eV, 2.89725658368996
*eV, 2.89308148472602*eV, 2.89175138144587*eV, 2.89038938625365*eV, 2.88760313928064*eV, 2.81810839670312*eV, 2.81399073458341*eV, 2.80853656938835
*eV, 2.80441563738327*eV, 2.79626159976358*eV, 2.79085529672382*eV, 2.78545960731583*eV, 2.77874426407913*eV, 2.77340542037697*eV, 2.76160625014209
*eV, 2.75782275002772*eV, 2.75406964541168*eV, 2.75160992458368*eV, 2.7491346223528*eV, 2.74797346650356*eV, 2.74551465879207*eV, 2.74433665672788
*eV, 2.74188435003155*eV, 2.74069953615878*eV, 2.73952566158141*eV, 2.73963473992199*eV, 2.73846177710232*eV, 2.73727001911571*eV, 2.73481055630116
*eV, 2.73621777736691*eV, 2.73247388211524*eV, 2.732582399613*eV, 2.73013134955437*eV, 2.73024952981097*eV, 2.72779283002983*eV, 2.72914363153895
*eV, 2.7254190568244*eV, 2.7242484270427*eV, 2.72182208624141*eV, 2.71940006361533*eV, 2.72076212444395*eV, 2.71833222400754*eV, 2.71714816380904*eV};

Sort(energyWLS_ABS,139);

    G4double energyWLS_EMS[128]=

    {2.68561474076266*eV, 2.67941907951687
*eV, 2.67569646693561*eV, 2.67198418392022*eV, 2.66703793652621*eV, 2.662091241297*eV, 2.65835122850108*eV, 2.65344597693042
*eV, 2.65092121040377*eV, 2.64601556381793*eV, 2.643541843059*eV, 2.63986294068174*eV, 2.6374282763983*eV, 2.63616671819557
*eV, 2.63370220511893*eV, 2.63125144328155*eV, 2.62999578586838*eV, 2.62517631520043*eV, 2.62156647764574*eV, 2.62032004454126
*eV, 2.61907479611562*eV, 2.61783978513795*eV, 2.61658784655139*eV, 2.61301059503758*eV, 2.60939812969085*eV, 2.60812728777295
*eV, 2.60458207972546*eV, 2.59984628616538*eV, 2.59283697379868*eV, 2.59044390893327*eV, 2.58694657945225*eV, 2.5834763172069
*eV, 2.57881689532818*eV, 2.57417425016787*eV, 2.5706857589925*eV, 2.56382390927743*eV, 2.56036339617135*eV, 2.55579552836258
*eV, 2.55348754889597*eV, 2.5511665356413*eV, 2.54997754124828*eV, 2.54768862851048*eV, 2.54428005916015*eV, 2.53977787067287
*eV, 2.53747319524071*eV, 2.53411734107666*eV, 2.5296425610396*eV, 2.52848198717931*eV, 2.52514143270966*eV, 2.52075703452372
*eV, 2.51417550363109*eV, 2.50876144018812*eV, 2.50015387938298*eV, 2.49060216954635*eV, 2.48115569977711*eV, 2.47597995731653
*eV, 2.47187748872642*eV, 2.4677966387459*eV, 2.46475085262374*eV, 2.46074948193771*eV, 2.46069348029575*eV, 2.45667336574488
*eV, 2.45467619124083*eV, 2.45369473032532*eV, 2.4516944522668*eV, 2.44969743284773*eV, 2.44874371583803*eV, 2.44680686743387
*eV, 2.44675149859789*eV, 2.44381264122578*eV, 2.44083360571197*eV, 2.43884637463946*eV, 2.43790893892364*eV, 2.43495210418004
*eV, 2.43197898965974*eV, 2.427013958197*eV, 2.42409124042164*eV, 2.42214666950791*eV, 2.41819733507655*eV, 2.41328066477641
*eV, 2.40740851855835*eV, 2.40546767504767*eV, 2.39960301202523*eV, 2.39571920880038*eV, 2.39087076969073*eV, 2.38799673103064
*eV, 2.38221684654371*eV, 2.37740791527079*eV, 2.37071090766005*eV, 2.36405890818048*eV, 2.35837213731859*eV, 2.35366621788097
*eV, 2.34992957472287*eV, 2.34431049648431*eV, 2.3396677043428*eV, 2.33224430754367*eV, 2.32488215088273*eV, 2.31936075674126
*eV, 2.31024703968258*eV, 2.30392256016919*eV, 2.29583681496604*eV, 2.29046622246695*eV, 2.28423564889116*eV, 2.27803202398693
*eV, 2.27186882330729*eV, 2.2622421933592*eV, 2.25355757443592*eV, 2.24666974556856*eV, 2.23898020046446*eV, 2.23218105825578
*eV, 2.22881335720249*eV, 2.22125187137917*eV, 2.21707678159487*eV, 2.21040981946408*eV, 2.20295965767012*eV, 2.19800157179113
*eV, 2.18737211837977*eV, 2.17520795557725*eV, 2.16638767431773*eV, 2.15763863514215*eV, 2.14815895073044*eV, 2.14111578670532
*eV, 2.13101614602314*eV, 2.12023694630047*eV, 2.10805229870239*eV, 2.09974971815193*eV, 2.08852080018987*eV, 2.07741134208064*eV};

Sort(energyWLS_EMS,128);

    G4double energyPLSTR_WLSfiber[101] = 

    {    1.17855691476331*eV, 1.18531727947514*eV, 1.19215564839519*eV, 1.19907337943036*eV, 1.20724622622298
    *eV, 1.21434071922723*eV, 1.22151908801083*eV, 1.22878282887116*eV, 1.23613347390927*eV, 1.24407171817278*eV, 1.25173334107117
    *eV, 1.25961787496799*eV, 1.26747278095583*eV, 1.27555748387963*eV, 1.28361308037167*eV, 1.29190567295092*eV, 1.30016975076657
    *eV, 1.30867835584864*eV, 1.31715911434293*eV, 1.32589228353224*eV, 1.33459835772981*eV, 1.34356510005526*eV, 1.352505589976
    *eV, 1.36171540288962*eV, 1.37089990527532*eV, 1.38036280820641*eV, 1.38995725821861*eV, 1.39952802159498*eV, 1.40939169527225
    *eV, 1.41923291475618*eV, 1.42937730497002*eV, 1.43950060876698*eV, 1.44993787198105*eV, 1.46035556458304*eV, 1.47109856944826
    *eV, 1.48182368152384*eV, 1.49288606180734*eV, 1.50393240457423*eV, 1.51532861687973*eV, 1.52671084143701*eV, 1.53845622823055
    *eV, 1.55018989038634*eV, 1.56230074890499*eV, 1.57440238010285*eV, 1.58689603779726*eV, 1.5993832228212*eV, 1.61227812006632
    *eV, 1.62516958229256*eV, 1.63848536319677*eV, 1.65180105826139*eV, 1.6655586705145*eV, 1.67954737785288*eV, 1.6935416942098
    *eV, 1.70800643935941*eV, 1.72248107020144*eV, 1.73744657277326*eV, 1.75242667749964*eV, 1.76791939873235*eV, 1.78343192510212
    *eV, 1.79948022399274*eV, 1.81555406989456*eV, 1.83218837643121*eV, 1.84885456953623*eV, 1.86610757725918*eV, 1.88339947490657
    *eV, 1.90130635536114*eV, 1.91925986738544*eV, 1.93785850942638*eV, 1.95651234705854*eV, 1.97584362443187*eV, 1.99523957890408
    *eV, 2.0153476500829*eV, 2.03553090515678*eV, 2.05646355005971*eV, 2.07748303339644*eV, 2.09929203239248*eV, 2.12156378222279
    *eV, 2.1439423730434*eV, 2.16717684728369*eV, 2.19053334687455*eV, 2.214794345*eV, 2.23919428270001*eV, 2.26455136864109
    *eV, 2.29006626215552*eV, 2.31659543036434*eV, 2.34330348578907*eV, 2.37108792184165*eV, 2.39907483423181*eV, 2.42820578599882
    *eV, 2.45756565774231*eV, 2.48814343634557*eV, 2.51897983407354*eV, 2.55111496775925*eV, 2.58354214280266*eV, 2.61735671169727
    *eV, 2.65150101439478*eV, 2.68713020011053*eV, 2.72313172486492*eV, 2.76072561641282*eV, 2.79874012264333*eV, 2.83846582951236*eV
};
Sort(energyPLSTR_WLSfiber,101);
    G4double energyPLSTR[33] = 

    {3.09296133114885*eV,3.08245368503076*eV,3.07586849786443*eV
,3.06207517455022*eV,3.055482836544*eV,3.04508806558541*eV,3.03113009184291*eV,3.02096887657423*eV
,3.00404800283831*eV,2.97034730907028*eV,2.94074146852609*eV,2.92457604370602*eV,2.89872304234068*eV
,2.86691860263066*eV,2.82960620734671*eV,2.76632524715516*eV,2.7029237722388*eV,2.63156842635673*eV
,2.57396286789817*eV,2.52127007156651*eV,2.47307433405918*eV,2.41533101087507*eV,2.33462896978486*eV
,2.27106075645099*eV,2.22227264141777*eV,2.16458841586528*eV,2.11672245095088*eV,2.0775962488384*eV
,2.03346110021594*eV,1.98807446365911*eV,1.9549718908276*eV,1.92295361720222*eV,1.90311050606434*eV
};
Sort(energyPLSTR,33);
     G4double energyTiO2[101] = 

    {1.9525*eV, 1.9596*eV, 1.9667*eV, 1.9739*eV, 1.9812*eV, 1.9885*eV, 1.9958*eV, 
    2.0032*eV, 2.0107*eV, 2.0183*eV, 2.0258*eV, 2.0335*eV, 2.0412*eV, 2.0489*eV, 
    2.0568*eV, 2.0646*eV, 2.0726*eV, 2.0806*eV, 2.0886*eV, 2.0968*eV, 2.1049*eV, 
    2.1132*eV, 2.1215*eV, 2.1299*eV, 2.1383*eV, 2.1469*eV, 2.1554*eV, 2.1641*eV, 
    2.1728*eV, 2.1816*eV, 2.1905*eV, 2.1994*eV, 2.2084*eV, 2.2175*eV, 2.2267*eV,
    2.2359*eV, 2.2452*eV, 2.2546*eV, 2.2641*eV, 2.2736*eV, 2.2833*eV, 2.2930*eV, 
    2.3028*eV, 2.3127*eV, 2.3226*eV, 2.3327*eV, 2.3428*eV, 2.3530*eV, 2.3634*eV,
    2.3738*eV, 2.3843*eV, 2.3949*eV, 2.4055*eV, 2.4163*eV, 2.4272*eV, 2.4382*eV, 
    2.4493*eV, 2.4604*eV, 2.4717*eV, 2.4831*eV, 2.4946*eV, 2.5062*eV, 2.5179*eV,
    2.5297*eV, 2.5417*eV, 2.5537*eV, 2.5658*eV, 2.5781*eV, 2.5905*eV, 2.6030*eV, 
    2.6157*eV, 2.6284*eV, 2.6413*eV, 2.6543*eV, 2.6674*eV, 2.6807*eV, 2.6941*eV, 
    2.7076*eV, 2.7213*eV, 2.7351*eV, 2.7490*eV, 2.7631*eV, 2.7774*eV, 2.7918*eV, 
    2.8063*eV, 2.8210*eV, 2.8358*eV, 2.8508*eV, 2.8660*eV, 2.8813*eV, 2.8968*eV, 
    2.9124*eV, 2.9285*eV, 2.9442*eV, 2.9604*eV, 2.9768*eV, 2.9933*eV, 3.0100*eV, 
    3.0269*eV, 3.0440*eV, 3.0613*eV};

    Sort(energyTiO2,101);
    
    G4double energyFastCompScin[] = 

    {3.26061310370512*eV,3.25006107310656*eV,3.23436046580522*eV,3.20852719459133*eV,3.18310332107306*eV,3.15308805926825
*eV,3.12849889023976*eV,3.10903043541418*eV,3.09930600383356*eV,3.08967432729145*eV,3.0848008722222
*eV,3.07522718721038*eV,3.06561789509624*eV,3.05603705127572*eV,3.019525*eV, 1.9596*eV, 1.9667*eV, 1.9739*eV, 1.9812*eV, 1.9885*eV, 1.9958*eV, 
    2.0032*eV, 2.0107*eV, 2.0183*eV, 2.0258*eV, 2.0335*eV, 2.0412*eV, 2.0489*eV, 
    2.0568*eV, 2.0646*eV, 2.0726*eV, 2.0806*eV, 2.0886*eV, 2.0968*eV, 2.1049*eV, 
    2.1132*eV, 2.1215*eV, 2.1299*eV, 2.1383*eV, 2.1469*eV, 2.1554*eV, 2.1641*eV, 
    2.1728*eV, 2.1816*eV, 2.1905*eV, 2.1994*eV, 2.2084*eV, 2.2175*eV, 2.2267*eV,
    2.2359*eV, 2.2452*eV, 2.2546*eV, 2.2641*eV, 2.2736*eV, 2.2833*eV, 2.2930*eV, 
    2.3028*eV, 2.3127*eV, 2.3226*eV, 2.3327*eV, 2.3428*eV, 2.3530*eV, 2.3634*eV,
    2.3738*eV, 2.3843*eV, 2.3949*eV, 2.4055*eV, 2.4163*eV, 2.4272*eV, 2.4382*eV, 
    2.4493*eV, 2.4604*eV, 2.4717*eV, 2.4831*eV, 2.4946*eV, 2.5062*eV, 2.5179*eV,
    2.5297*eV, 2.5417*eV, 2.5537*eV, 2.5658*eV, 2.5781*eV, 2.5905*eV, 2.6030*eV, 
    2.6157*eV, 2.6284*eV, 2.6413*eV, 2.6543*eV, 2.6674*eV, 2.6807*eV, 2.6941*eV, 
    2.7076*eV, 2.7213*eV, 2.7351*eV, 2.7490*eV, 2.7631*eV, 2.7774*eV, 2.7918*eV, 
    2.8063*eV, 2.8210*eV, 2.8358*eV, 2.8508*eV, 2.8660*eV, 2.8813*eV, 2.8968*eV, 
    2.9124*eV, 2.9285*eV, 2.9442*eV, 2.9604*eV, 2.9768*eV, 2.9933*eV, 3.0100*eV, 
    3.0269*eV, 3.0440*eV, 3.06135104983066675*eV,3.04137297604579
*eV,3.03627839284706*eV,3.02657160072585*eV,3.02140360059451*eV,3.01173050516896*eV,3.00214946829558
*eV,2.99256894399448*eV,2.98751631661047*eV,2.98254056980297*eV,2.97320353715361*eV,2.96839387333931
*eV,2.95929235905399*eV,2.95027576744203*eV,2.94140126506923*eV,2.93692597144444*eV,2.9282757008914
*eV,2.91976226821683*eV,2.91555268344817*eV,2.91138373293856*eV,2.90310984854576*eV,2.8949110497214
*eV,2.89091333150204*eV,2.88283909433737*eV,2.87890250589976*eV,2.87083967716778*eV,2.86282188479725
*eV,2.85484875250119*eV,2.85087881743605*eV,2.84289041315633*eV,2.83892653161265*eV,2.83095095567579
*eV,2.81903116217821*eV,2.80718481563522*eV,2.79549019213914*eV,2.78389260310066*eV,2.77624876069757
*eV,2.76864677934685*eV,2.7611119619893*eV,2.75739827702924*eV,2.74994991675864*eV,2.74631691997276
*eV,2.73892822573287*eV,2.73162938369929*eV,2.7280446011333*eV,2.72449418518813*eV,2.71727196822358
*eV,2.71008794000941*eV,2.70294179844963*eV,2.69948089404006*eV,2.69600439001371*eV,2.68533727237301
*eV,2.68189707919103*eV,2.67487457417411*eV,2.67143711179133*eV,2.66444532528764*eV,2.66101077817685
*eV,2.65758507412827*eV,2.64712493589994*eV,2.64371135643563*eV,2.636863760604*eV,2.62318184350654
*eV,2.61303618972506*eV,2.59964526188853*eV,2.58639088225251*eV,2.57327097282478*eV,2.56680513290239
*eV,2.55066142736018*eV,2.53794394259058*eV,2.52846723642226*eV,2.51592697709508*eV,2.50351049395058
*eV,2.49117420933638*eV,2.47893823270839*eV,2.46682186821977*eV,2.45184701713673*eV,2.43115327912469
*eV,2.41080593038207*eV,2.39077711781253*eV,2.36828263266166*eV,2.34896987840328*eV,2.32721521941278
*eV,2.30325137956124*eV,2.27974106408752*eV,2.26433811224457*eV,2.24411607633482*eV,2.22673455270595
*eV,2.20473656689998*eV,2.19031112852063*eV,2.17371822640263*eV,2.15737483617719*eV,2.13671956507329*eV
};

Sort(energyFastCompScin,106);

    G4double energy[50] = 

    {2.00*eV,2.03*eV,2.06*eV,2.09*eV,2.12*eV,
   2.15*eV,2.18*eV,2.21*eV,2.24*eV,2.27*eV,
   2.30*eV,2.33*eV,2.36*eV,2.39*eV,2.42*eV,
   2.45*eV,2.48*eV,2.51*eV,2.54*eV,2.57*eV,
   2.60*eV,2.63*eV,2.66*eV,2.69*eV,2.72*eV,
   2.75*eV,2.78*eV,2.81*eV,2.84*eV,2.87*eV,
   2.90*eV,2.93*eV,2.96*eV,2.99*eV,3.02*eV,
   3.05*eV,3.08*eV,3.11*eV,3.14*eV,3.17*eV,
   3.20*eV,3.23*eV,3.26*eV,3.29*eV,3.32*eV,
   3.35*eV,3.38*eV,3.41*eV,3.44*eV,3.47*eV};

Sort(energy,50);

   G4double energyPMMArindex[101] = 

   {1.14482167528255
*eV,1.15226939993587*eV,1.15981466261085*eV,1.1663611235475*eV,1.17409268402557*eV,1.18192743024881
*eV,1.18986744177639*eV,1.19675856595656*eV,1.20489978069096*eV,1.21315251891487*eV,1.22151908801083
*eV,1.23000185945535*eV,1.2373671400509*eV,1.24632275264475*eV,1.25490068252125*eV,1.2634687397646
*eV,1.27228514554233*eV,1.28122545657848*eV,1.29029230339369*eV,1.29948839150089*eV,1.3088165040969
*eV,1.31813935182968*eV,1.32773813914221*eV,1.33747775008738*eV,1.34736130659748*eV,1.35739202357236
*eV,1.36757321236598*eV,1.37775516649739*eV,1.38824529653006*eV,1.39889639437098*eV,1.40971219366799
*eV,1.42069654443795*eV,1.43185341763598*eV,1.44301894126047*eV,1.4545305893137*eV,1.46622738213221
*eV,1.47811382252146*eV,1.49019456049399*eV,1.5024743993347*eV,1.51477321237752*eV,1.5274631937058
*eV,1.54036759141632*eV,1.55349188614334*eV,1.56684174691141*eV,1.58042303930019*eV,1.59403686594368
*eV,1.60809581625291*eV,1.62240496510206*eV,1.63697105140084*eV,1.65180105826139*eV,1.66667814804543
*eV,1.68205382489621*eV,1.69771583504176*eV,1.71367225201244*eV,1.72993145574298*eV,1.7465021472475
*eV,1.7631425971715*eV,1.78035880863153*eV,1.79791455094402*eV,1.8158199682645*eV,1.83408561291568
*eV,1.85272246612522*eV,1.87145943295245*eV,1.89086758324081*eV,1.91068250012482*eV,1.93091710688522
*eV,1.95158488010546*eV,1.97269987960381*eV,1.9939560539257*eV,2.01600304769268*eV,2.03854303573002
*eV,2.06159274082307*eV,2.08516965074167*eV,2.10929206248894*eV,2.13361189869385*eV,2.15887493353822
*eV,2.18474339089162*eV,2.21123929789727*eV,2.23838576337064*eV,2.26620704502101*eV,2.29430398654885
*eV,2.32354174349887*eV,2.353534309664*eV,2.38431129679038*eV,2.41590388606975*eV,2.44834493351303
*eV,2.48117245213327*eV,2.51540246364576*eV,2.55059015497017*eV,2.58677628694137*eV,2.62400396683809
*eV,2.66231881969293*eV,2.70118055409803*eV,2.74179981055063*eV,2.78365934964301*eV,2.8268168589398
*eV,2.87133365986799*eV,2.91727499842588*eV,2.96400161207506*eV,3.0129814686051*eV,3.06360730005188*eV
};

Sort(energyPMMArindex,101);

   G4double energyPMMA[100] = 

   {1.3990825688034*eV,1.46100917431193*eV,1.52981651376147*eV,1.61926605504587*eV,1.72247706422018
*eV,1.81192660550459*eV,1.92201834862385*eV,1.99770642201835*eV,2.09403669724771*eV,2.17660550458716
*eV,2.27981651376147*eV,2.37614678899083*eV,2.44495412844037*eV,2.51376146788991*eV,2.58256880733945
*eV,2.65825688073394*eV,2.72706422018349*eV,2.78899082568807*eV,2.87155963302752*eV,2.96788990825688
*eV,3.04357798165138*eV,3.10550458715596*eV,3.1743119266055*eV,3.22247706422018*eV,3.25
*eV,3.28440366972477*eV,3.31192660550459*eV,3.34633027522936*eV,3.37385321100917*eV,3.4151376146789
*eV,3.44954128440367*eV,3.49770642201835*eV,3.55275229357798*eV,3.62155963302752*eV,3.67660550458715
*eV,3.73853211009174*eV,3.79357798165138*eV,3.84174311926605*eV,3.88990825688073*eV,3.95183486238532
*eV,4.00688073394495*eV,4.0756880733945*eV,4.13073394495413*eV,4.20642201834862*eV,4.2545871559633
*eV,4.31651376146789*eV,4.36467889908257*eV,4.39908256880734*eV,4.40596330275229*eV,4.41284403669725
*eV,4.42660550458715*eV,4.44036697247706*eV,4.45412844036697*eV,4.44724770642202*eV,4.46788990825688
*eV,4.48165137614679*eV,4.47477064220183*eV,4.48853211009174*eV,4.52293577981651*eV,4.5848623853211
*eV,4.64678899082569*eV,4.69495412844037*eV,4.72935779816514*eV,4.79816513761468*eV,4.84633027522936
*eV,4.9151376146789*eV,4.93577981651376*eV,4.96330275229358*eV,5.01146788990826*eV,5.03899082568807
*eV,5.05963302752294*eV,5.09403669724771*eV,5.12155963302752*eV,5.15596330275229*eV,5.19724770642202
*eV,5.21788990825688*eV,5.28669724770642*eV,5.34174311926606*eV,5.43119266055046*eV,5.48623853211009
*eV,5.54128440366972*eV,5.5756880733945*eV,5.61009174311927*eV,5.64449541284404*eV,5.70642201834862
*eV,5.76834862385321*eV,5.81651376146789*eV,5.87155963302752*eV,5.93348623853211*eV,5.98165137614679
*eV,6.01605504587156*eV,6.06422018348624*eV,6.11238532110092*eV,6.18119266055046*eV,6.23623853211009
*eV,6.30504587155963*eV,6.36009174311927*eV,6.42889908256881*eV,6.47706422018349*eV,6.53899082568807*eV
};

Sort(energyPMMA,100);

    G4double rindexWorld[50] =

    { 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00,
    1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00,
    1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00,
    1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00,
    1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00};

    G4double abslengthWorld[50] = 

    {10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm,
    10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm,
    10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm,
    10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm,
    10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm, 10.*cm};

    G4double rindexPLSTR_WLSfiber[101] = 

    {1.57173751929191, 1.57183767048388, 1.57193959752647, 1.57204334288007, 1.57216673570129, 1.5722745725719
, 1.57238437090548, 1.57249617883041, 1.5726100459686, 1.57273383164592, 1.57285410857491
, 1.57297871130323, 1.57310368042695, 1.57323317666771, 1.57336308679561, 1.57349773781522
, 1.57363285457366, 1.5737729394217, 1.57391354664512, 1.57405936363607, 1.5742057648952
, 1.57435763323716, 1.5745101535199, 1.5746684151073, 1.57482740267012, 1.57499242405966
, 1.57516100018274, 1.57533042706139, 1.57550636561447, 1.57568324790034, 1.57586698727827
, 1.57605177234979, 1.57624378432447, 1.57643695389331, 1.57663774673376, 1.57683982008064
, 1.57704994202141, 1.57726147959622, 1.57748152269937, 1.57770313013348, 1.57793373459678
, 1.57816606718274, 1.57840792615411, 1.57865169385668, 1.5789055588248, 1.57916153189702
, 1.57942821873881, 1.57969723402883, 1.57997762980774, 1.58026059785603, 1.5805556684805
, 1.58085852964536, 1.58116438039372, 1.58148353699824, 1.58180599920256, 1.58214265507228
, 1.58248296792772, 1.58283844141791, 1.58319796321395, 1.58357370068596, 1.58395392296769
, 1.58435151417249, 1.58475407792813, 1.58517527361528, 1.58560198783158, 1.58604871996341
, 1.5865015829577, 1.58697598798345, 1.58745721200306, 1.58796165774036, 1.5884736974208
, 1.58901081420552, 1.58955639960347, 1.59012911651019, 1.59071129158208, 1.59132287869285
, 1.59195541990913, 1.59259916420239, 1.59327624748295, 1.59396589693832, 1.59469188317771
, 1.5954319922665, 1.59621179926513, 1.59700751228532, 1.59784670384817, 1.59870385068878
, 1.599608743092, 1.60053395395512, 1.60151174382247, 1.60251258738628, 1.60357150612248
, 1.60465665687593, 1.60580615826104, 1.60698560039127, 1.60823658987594, 1.60952186729292
, 1.61088698413213, 1.61229150918573, 1.61378547606689, 1.61532491355697, 1.6169649731974 };

//Sort(rindexPLSTR_WLSfiber,101);

     G4double rindexTiO2[101]=

    { 
  2.48921047291944, 2.49005019541613, 2.490900212162, 2.49176069654864, 2.49263182572257, 2.49351378068545, 2.49440674639734
, 2.49531091188343, 2.49622647034409, 2.49715361926854, 2.49809256055217, 2.49904350061777, 2.50000665054069, 2.50098222617811
, 2.50197044830272, 2.50297154274077, 2.50398574051474, 2.50501327799096, 2.5060543970321, 2.50710934515494, 2.50817837569359
, 2.50926174796827, 2.51035972746, 2.5114725859914, 2.51260060191386, 2.51374406030124, 2.51490325315055, 2.51607847958978
, 2.51727004609316, 2.51847826670429, 2.51970346326732, 2.5209459656666, 2.52220611207525, 2.52348424921279, 2.52478073261252
, 2.52609592689883, 2.52743020607506, 2.52878395382222, 2.53015756380917, 2.53155144001473, 2.53296599706227, 2.53440166056729
, 2.53585886749871, 2.5373380665543, 2.53883971855116, 2.54036429683174, 2.5419122876862, 2.54348419079189, 2.54508051967084
, 2.54670180216591, 2.54834858093673, 2.55002141397627, 2.55172087514906, 2.55344755475216, 2.55520206009994, 2.55698501613396
, 2.55879706605916, 2.56063887200763, 2.56251111573147, 2.56441449932624, 2.56634974598644, 2.56831760079489, 2.57031883154764
, 2.57235422961638, 2.57442461085029, 2.57653081651954, 2.57867371430257, 2.58085419931971, 2.58307319521555, 2.58533165529284
, 2.58763056370076, 2.58997093668073, 2.59235382387295, 2.59478030968709, 2.5972515147411, 2.59976859737179, 2.60233275522165
, 2.6049452269064, 2.60760729376795, 2.61032028171817, 2.61308556317882, 2.61590455912367, 2.61877874122911, 2.62170963414005
, 2.62469881785843, 2.62774793026215, 2.63085866976278, 2.63403279811124, 2.63727214336094, 2.64057860299901, 2.64395414725685
, 2.64740082261195, 2.65092075549439, 2.65451615621185, 2.65818932310841, 2.66194264697383, 2.66577861572087, 2.66969981935005
, 2.67370895522285, 2.67780883366577, 2.68200238393016};

//Sort(rindexTiO2,101);

G4double energyTiO2abs[101] = 
    
    {6.21179778339618
*eV,6.1969106348796*eV,6.15161186299221*eV,6.1219541489156*eV,6.06317310891595*eV,6.03453037554787
*eV,5.99162221918557*eV,5.93511356845196*eV,5.86565068340281*eV,5.77066434245605*eV,5.71756563283648
*eV,5.70424031547509*eV,5.6780516594539*eV,5.63927846019905*eV,5.60093336150143*eV,5.56320273211718
*eV,5.50156132374736*eV,5.48917574969665*eV,5.44113243511556*eV,5.40565394312858*eV,5.35910011449321
*eV,5.32472415962767*eV,5.24654672417002*eV,5.20297741935484*eV,5.1495177719424*eV,5.07634501089471
*eV,5.0353479979584*eV,4.97503097844955*eV,4.89693920596102*eV,4.8213517417742*eV,4.76609526294959
*eV,4.72988614649006*eV,4.6245363294793*eV,4.55692074412804*eV,4.49946313537692*eV,4.45942743896397
*eV,4.43584437709576*eV,4.41252461590863*eV,4.37416366998917*eV,4.34395477414252*eV,4.32913046624079
*eV,4.31440699396327*eV,4.285029388259*eV,4.24880189711234*eV,4.22032187070672*eV,4.19219370296098
*eV,4.1575665111718*eV,4.13712747664124*eV,4.11686198955148*eV,4.09010469407508*eV,4.06371871949278
*eV,4.0182148173967*eV,3.99274535142733*eV,3.94260535680525*eV,3.88768950836866*eV,3.84010313043166
*eV,3.79946681750785*eV,3.77099040857041*eV,3.73179618226655*eV,3.70433213356806*eV,3.66647290616946
*eV,3.63467686758461*eV,3.59307986471135*eV,3.56248924933091*eV,3.5324151189645*eV,3.48819189702277
*eV,3.44033993481541*eV,3.40763359938677*eV,3.35742813280854*eV,3.30862081464598*eV,3.2401283995983
*eV,3.18649717802797*eV,3.13853999955951*eV,3.08817064178984*eV,3.0356874675576*eV,2.98853354736331
*eV,2.93591031779552*eV,2.87513486840114*eV,2.80735380531322*eV,2.73369204500039*eV,2.65530381054717
*eV,2.56276340128986*eV,2.5062523114398*eV,2.43782338485489*eV,2.37754535299859*eV,2.31373443606459
*eV,2.25529587703557*eV,2.1920179451857*eV,2.1449961548593*eV,2.1052647774233*eV,2.05846568495509
*eV,2.00884464020976*eV,1.96001874175217*eV,1.91205222701037*eV,1.86358943041704*eV,1.82816034223597
*eV,1.78000235033764*eV,1.73672602172743*eV,1.70358934695214*eV,1.64311865022501*eV,1.59694153453927*eV
};

Sort(energyTiO2abs,101);

G4double abslengthTiO2[101] = 

    {1.30534351145038E-06
*cm,1.35213494992093E-06*cm,1.39629831246598E-06*cm,1.44670050761421E-06*cm,1.51865008880995E-06*cm,1.60212367270456E-06
*cm,1.67318982387476E-06*cm,1.73662830060934E-06*cm,1.76531314521679E-06*cm,1.72727272727273E-06*cm,1.67318982387476E-06
*cm,1.62650602409639E-06*cm,1.58235657001851E-06*cm,1.52951699463327E-06*cm,1.46655231560892E-06*cm,1.42105263157895E-06
*cm,1.36654235482152E-06*cm,1.32970451010887E-06*cm,1.3000506842372E-06*cm,1.27930174563591E-06*cm,1.25673689367957E-06
*cm,1.24213075060533E-06*cm,1.24696159455518E-06*cm,1.25920471281296E-06*cm,1.274217585693E-06*cm,1.27675460428074E-06
*cm,1.26416954164613E-06*cm,1.23972933784437E-06*cm,1.22317596566524E-06*cm,1.21852731591449E-06*cm,1.20479098168154E-06
*cm,1.18695048588616E-06*cm,1.14253897550111E-06*cm,1.12057667103539E-06*cm,1.11473272490222E-06*cm,1.12648221343874E-06
*cm,1.14662494412159E-06*cm,1.16963064295486E-06*cm,1.20479098168154E-06*cm,1.2349542609533E-06*cm,1.27169062964799E-06
*cm,1.31067961165049E-06*cm,1.34928984744871E-06*cm,1.38723634396971E-06*cm,1.43376187814421E-06*cm,1.47668393782383E-06
*cm,1.53684841222289E-06*cm,1.5941578620261E-06*cm,1.64739884393064E-06*cm,1.70886075949367E-06*cm,1.78496868475992E-06
*cm,1.8736303871439E-06*cm,1.96551724137931E-06*cm,2.08706265256306E-06*cm,2.24802804557406E-06*cm,2.38161559888579E-06
*cm,2.56243756243756E-06*cm,2.73745997865528E-06*cm,2.97909407665505E-06*cm,3.23455233291299E-06*cm,3.51851851851852E-06
*cm,3.9041095890411E-06*cm,4.41480206540448E-06*cm,4.84877126654065E-06*cm,5.37735849056604E-06*cm,6.09263657957245E-06
*cm,7.18487394957983E-06*cm,8.40983606557378E-06*cm,1.04693877551021E-05*cm,1.20422535211268E-05*cm,1.63375796178344E-05
*cm,1.98837209302326E-05*cm,2.44285714285715E-05*cm,2.88202247191011E-05*cm,3.16666666666668E-05*cm,3.71739130434784E-05
*cm,4.50000000000002E-05*cm,4.50000000000002E-05*cm,5.70000000000002E-05*cm,6.93243243243251E-05*cm,7.77272727272731E-05
*cm,8.84482758620687E-05*cm,0.000122142857143*cm,0.000122142857143*cm,0.000122142857143*cm,0.000122142857143
*cm,0.000150882352941*cm,0.000150882352941*cm,0.000122142857143*cm,0.000197307692308*cm,0.000285
*cm,0.000285*cm,0.000197307692308*cm,0.000285*cm,0.000197307692308*cm,0.000285
*cm,0.000513*cm,0.002565*cm,0.002565*cm,0.000150882352941*cm,0.000285*cm
};

//Sort(abslengthTiO2,101);
    G4double rindexPMMA[101] = 

    { 1.48146079142622
,1.4815180213019,1.48157597524704,1.48162624844685,1.48168562500359,1.48174581085742
,1.4818068372909,1.48185983900733,1.48192251234551,1.48198612031969,1.48205069763026
,1.48211627997985,1.48217332118391,1.48224281447797,1.48230952863809,1.48237632580014
,1.48244523732725,1.4825153134007,1.48258659433426,1.48265912175251,1.48273293865478
,1.48280697444056,1.48288348451393,1.48296142129472,1.48304083396164,1.48312177343803
,1.48320429247786,1.48328719609911,1.48337301502081,1.4834605828017,1.48354996044112
,1.48364121127234,1.48373440108085,1.48382818339117,1.48392542785855,1.48402482355097
,1.48412644734184,1.48423037925625,1.48433670263699,1.48444388591169,1.48455521796449
,1.48466921181615,1.48478596589061,1.48490558292201,1.48502817019264,1.48515196881782
,1.48528078996405,1.4854129312597,1.48554852079768,1.48568769265801,1.48582845819799
,1.48597516465012,1.48612589287488,1.48628080452305,1.48644006922823,1.48660386509533
,1.48676986596176,1.4869432212593,1.48712169517637,1.48730550517701,1.48749488022214
,1.4876900615199,1.48788829872019,1.48809577415989,1.48830985709198,1.48853084621971
,1.48875905721348,1.48899482389898,1.48923485701288,1.48948669109928,1.48974719871226
,1.49001679994682,1.49029594066228,1.49058509443088,1.49088027903071,1.49119083471896
,1.49151300404488,1.49184739416046,1.49219465267633,1.49255547099223,1.49292496421586
,1.49331494226534,1.49372084264494,1.49414357146049,1.49458410095012,1.49504347546484
,1.49551561859178,1.49601581792151,1.49653847819898,1.49708500479504,1.49765691657896
,1.49825585732665,1.49887415908122,1.49953218736615,1.50022302930095,1.50094897044924
,1.50171250336679,1.50251635107906,1.50335070686466,1.50424370258809,1.50518679643968
};

//Sort(rindexPMMA,101);

    G4double emissionWLSfiber[128] = 

    {0.018556701030928,0.028865979381444
,0.039175257731959,0.049484536082474,0.065979381443299,0.08659793814433,0.111340206185567,0.129896907216495
,0.156701030927835,0.181443298969072,0.2,0.222680412371134,0.235051546391752,0.251546391752577
,0.272164948453608,0.290721649484536,0.307216494845361,0.329896907216495,0.348453608247423,0.364948453608247
,0.381443298969072,0.395876288659794,0.414432989690722,0.430927835051546,0.457731958762887,0.482474226804124
,0.496907216494845,0.521649484536082,0.544329896907216,0.56701030927835,0.581443298969072,0.591752577319588
,0.616494845360825,0.641237113402062,0.663917525773196,0.688659793814433,0.711340206185567,0.734020618556701
,0.752577319587629,0.775257731958763,0.793814432989691,0.810309278350515,0.830927835051546,0.851546391752577
,0.876288659793814,0.890721649484536,0.91340206185567,0.929896907216495,0.946391752577319,0.954639175257732
,0.975257731958763,0.981443298969072,0.989690721649484,0.983505154639175,0.969072164948454,0.950515463917526
,0.929896907216495,0.907216494845361,0.888659793814433,0.851546391752577,0.865979381443299,0.837113402061856
,0.820618556701031,0.808247422680412,0.793814432989691,0.779381443298969,0.760824742268041,0.731958762886598
,0.746391752577319,0.71340206185567,0.692783505154639,0.680412371134021,0.65979381443299,0.637113402061855
,0.620618556701031,0.6,0.575257731958763,0.558762886597938,0.544329896907216,0.525773195876289
,0.503092783505154,0.492783505154639,0.478350515463917,0.465979381443299,0.45360824742268,0.439175257731959
,0.424742268041237,0.416494845360825,0.404123711340206,0.389690721649484,0.381443298969072,0.371134020618557
,0.358762886597938,0.350515463917526,0.338144329896907,0.327835051546392,0.31340206185567,0.311340206185567
,0.298969072164948,0.28659793814433,0.272164948453608,0.265979381443299,0.257731958762887,0.251546391752577
,0.243298969072165,0.23298969072165,0.224742268041237,0.214432989690722,0.2,0.189690721649485
,0.179381443298969,0.162886597938144,0.152577319587629,0.142268041237113,0.129896907216495,0.127835051546392
,0.111340206185567,0.101030927835051,0.088659793814433,0.076288659793814,0.068041237113402,0.057731958762887
,0.045360824742268,0.035051546391753,0.022680412371134,0.016494845360825,0.012371134020619,0.008247422680412
    };

//Sort(emissionWLSfiber,128);

    G4double abslengthPLSTR_WLSfiber[139] = 
    {
 9.57249437492597*cm, 8.77478651034885*cm, 7.52124558029899*cm, 6.79338310478618*cm, 5.84985767356588*cm, 5.01416372019933*cm, 4.21189752496743
*cm, 3.69464695172582*cm, 3.19083145830866*cm, 2.77098521379436*cm, 2.42063076147554*cm, 2.21678817103549*cm, 1.98674411555068
*cm, 1.79995620725104*cm, 1.67138790673311*cm, 1.59541572915433*cm, 1.5042491160598*cm, 1.42293835302954*cm, 1.31621797655232
*cm, 1.2610471631639*cm, 1.21031538073777*cm, 1.14453737091506*cm, 1.08554059921841*cm, 1.02230522450666*cm, 0.434216239687364
*cm, 0.440575054912912*cm, 0.440575054912912*cm, 0.449029586883522*cm, 0.449029586883522*cm, 0.706694215598563*cm, 0.51616391237346
*cm, 26.3243595310466*cm, 30.0849823211961*cm, 35.0991460413954*cm, 19.144988749852*cm, 14.0396584165581*cm, 10.5297438124186
*cm, 7.79981023142117*cm, 5.84985767356588*cm, 4.89755526159003*cm, 4.29785461731371*cm, 3.76062279014949*cm, 3.09698347424076
*cm, 2.59993674380706*cm, 2.26446103492873*cm, 0.733780056614536*cm, 0.738929390345164*cm, 0.723693732812274*cm, 0.711469176514769
*cm, 0.726189228442661*cm, 0.711469176514769*cm, 0.695032594879115*cm, 0.718753843851098*cm, 0.738929390345164*cm, 0.754820344976243
*cm, 0.779981023142117*cm, 0.806876920491846*cm, 0.832390815210955*cm, 0.877478651034882*cm, 0.911666130945332*cm, 0.961620439490282
*cm, 0.726189228442661*cm, 0.718753843851098*cm, 0.713880936435158*cm, 0.697334027312489*cm, 0.679338310478618*cm, 0.662248038516892
*cm, 0.642057549537719*cm, 0.630523581581951*cm, 0.690475004093022*cm, 0.668555162693244*cm, 0.649984185951765*cm, 0.630523581581951
*cm, 0.67498357771914*cm, 0.651996520892792*cm, 0.632417045790906*cm, 0.615774491954303*cm, 0.458812366554187*cm, 0.467988613885271
*cm, 0.483015771211862*cm, 0.494354169597117*cm, 0.505023684048853*cm, 0.517432128374378*cm, 0.531805243051444*cm, 0.544172806843338
*cm, 0.555659304085413*cm, 0.570717821811305*cm, 0.584985767356588*cm, 0.598280898432874*cm, 0.456821857371739*cm, 0.470077848768687
*cm, 0.48524165034187*cm, 0.497860227537522*cm, 0.514901897917779*cm, 0.529132854895406*cm, 0.548424156896801*cm, 0.563087904407411
*cm, 0.580151174237939*cm, 0.594900780362632*cm, 0.605157690368884*cm, 0.615774491954303*cm, 0.62122382374151*cm, 0.612194407698755
*cm, 0.603423714178716*cm, 0.589901614141097*cm, 0.572268685457532*cm, 0.561586336662325*cm, 0.54985607375554*cm, 0.53586482505947
*cm, 0.526487190620929*cm, 0.523867851364109*cm, 0.539986862175312*cm, 0.560092755979712*cm, 0.580151174237939*cm, 0.598280898432874
*cm, 0.62122382374151*cm, 0.644021028282482*cm, 0.666439481798645*cm, 0.692746303448591*cm, 0.716309102885618*cm, 0.744151506177992
*cm, 0.77424586856019*cm, 0.806876920491846*cm, 0.835693953366554*cm, 0.870226761356908*cm, 0.919628280560575*cm, 0.957249437492599
*cm, 1.00763098683431*cm, 1.05826570979081*cm, 1.12617580881482*cm, 1.18311728229422*cm, 1.2387933896963*cm, 1.30804270961722
*cm, 1.39466805462498*cm, 1.5042491160598*cm, 1.63251842053001*cm, 1.76970484242329*cm, 1.93206308484745*cm, 2.08509778463734*cm
};
    
   //Sort(abslengthPLSTR_WLSfiber,139);
   

    G4double abslengthPMMA[100] = 

    {0.471709787248755*cm,0.4722239523859*cm,0.472796563192909*cm,0.473543036591083*cm,0.474407286379757
*cm,0.475158858654971*cm,0.604897941091737*cm,0.430797398825685*cm,0.477544878748647*cm,0.535525644547348
*cm,0.536631210554257*cm,0.395129931234168*cm,0.43391361027647*cm,0.434397033311586*cm,0.396334858055619
*cm,0.435415736073004*cm,0.364780412178237*cm,0.365087815513853*cm,0.365498493471711*cm,0.365978787025491
*cm,0.366357046979867*cm,0.33887833525782*cm,0.294496056280279*cm,0.233186952138476*cm,0.170856234271907
*cm,0.13482382347275*cm,0.117174613941468*cm,0.092855587610909*cm,0.081077484285698*cm,0.071953643606224
*cm,0.0628561821921*cm,0.055802580196684*cm,0.052530727095659*cm,0.051331547905633*cm,0.052543469221173
*cm,0.053814743176445*cm,0.055836942445823*cm,0.056548763508586*cm,0.053190730559881*cm,0.051364005901659
*cm,0.050215628265701*cm,0.050792587381875*cm,0.051978898855434*cm,0.055195119041119*cm,0.058068029989703
*cm,0.063883980085995*cm,0.059631031137756*cm,0.053244480686059*cm,0.047078548191794*cm,0.042192483030162
*cm,0.037583049787875*cm,0.034669678004489*cm,0.032408697066741*cm,0.030218242369489*cm,0.027778416706784
*cm,0.026001903442678*cm,0.024174251308196*cm,0.02281756879898*cm,0.022031240036195*cm,0.021399695786486
*cm,0.020900590178095*cm,0.020424021287868*cm,0.019879717714651*cm,0.020059103713715*cm,0.019793432841016
*cm,0.019707196474112*cm,0.019199765890828*cm,0.018562491031126*cm,0.017966410075134*cm,0.017475218427425
*cm,0.017075052128657*cm,0.016818520732301*cm,0.016882311971686*cm,0.017011134622037*cm,0.016947104563317
*cm,0.016694231860797*cm,0.016510016610673*cm,0.016449835523342*cm,0.016153586197223*cm,0.015867495690645
*cm,0.01586801229507*cm,0.01570117285925*cm,0.015377499077416*cm,0.015117841574397*cm,0.015169659347396
*cm,0.015118896737541*cm,0.014967477860213*cm,0.014770167223429*cm,0.014625729314477*cm,0.014531050766786
*cm,0.014344849044188*cm,0.014208467837865*cm,0.014163821994256*cm,0.014030996753093*cm,0.01381464797287
*cm,0.013646486130819*cm,0.013482275788552*cm,0.013361871453133*cm,0.013282804662433*cm,0.013165876850408*cm
};

//Sort(abslengthPMMA,100);

   G4double abslengthPLSTR[33] = 

    {23.9127736223345*cm,29.65370858408*cm,39.5032539492865*cm
,53.5813227957207*cm,68.8658110154972*cm,80.9295823566449*cm,92.589270945862*cm,111.77302692909*cm,144.972455578546*cm
,205.709934459544*cm,291.87882478413*cm,358.761343588923*cm,429.34194780661*cm,509.278090241026*cm,609.596497763209*cm
,736.584993251856*cm,866.46894603702*cm,1010.3736773164*cm,1086.68359037551*cm,1158.27275822176*cm,1245.62418764122*cm
,1339.90948401193*cm,1468.30091616449*cm,1594.14965038693*cm,1714.81595868223*cm,1845.18803600205*cm,1949.80932627513*cm
,2059.93665964048*cm,2176.73409546136*cm,2259.53971058271*cm,2323.73467683117*cm,2389.75346306931*cm,2413.00526797441*cm};

//Sort(abslengthPLSTR,33);

    G4double fraction[106] = 

    {0.000151549594595,0.000151549594595,0.000151549594595,0.000151549594595,0.000151549594595,0.000227324391892
,0.000303099189189,0.000530423581081,0.00083352277027,0.001060847162162,0.001363946351351
,0.00166704554054,0.00219746912162,0.002803667499998,0.003637190270268,0.004698037432429
,0.005910434189185,0.007274380540536,0.008789876486481,0.010305372432426,0.011745093581074
,0.013336364324316,0.014851860270261,0.016215806621611,0.017503978175665,0.018564825337826
,0.019474122905393,0.020307645675663,0.020913844054041,0.021368492837824,0.021595817229716
,0.021595817229716,0.021520042432419,0.021368492837824,0.020989618851338,0.020534970067555
,0.020080321283771,0.019474122905393,0.018943699324312,0.018489050540529,0.018034401756745
,0.017579752972962,0.01735242858107,0.017125104189178,0.016973554594584,0.016897779797287
,0.016897779797287,0.016973554594584,0.016897779797287,0.016822004999989,0.016670455405395
,0.0165189058108,0.016291581418909,0.016064257027017,0.015761157837828,0.015382283851342
,0.015079184662153,0.014624535878369,0.014245661891883,0.0137910131081,0.013336364324316
,0.012881715540533,0.012427066756749,0.011896643175668,0.011441994391885,0.010987345608101
,0.010532696824318,0.010153822837832,0.009774948851345,0.009471849662156,0.009168750472967
,0.008865651283778,0.008714101689184,0.008486777297292,0.008183678108103,0.007880578918914
,0.007577479729725,0.007122830945941,0.006668182162158,0.006213533378374,0.005834659391888
,0.005304235810807,0.004698037432429,0.004319163445943,0.00386451466216,0.003409865878376
,0.003106766689187,0.002879442297295,0.002652117905404,0.002349018716215,0.002045919527026
,0.001742820337837,0.001515495945945,0.001288171554053,0.000985072364864,0.000909297567567
,0.000681973175675,0.000606198378378,0.000530423581081,0.000454648783784,0.000303099189189
,0.000303099189189,0.000303099189189,0.000303099189189,0.000303099189189,0.000303099189189
};

//Sort(fraction,106);



    G4MaterialPropertiesTable *mptWorld = new G4MaterialPropertiesTable();
    mptWorld->AddProperty("RINDEX", energy, rindexWorld, 50);
    mptWorld->AddProperty("ABSLENGTH", energy, abslengthWorld, 50);


    G4MaterialPropertiesTable *mptWLS_Core = new G4MaterialPropertiesTable();

   mptWLS_Core->AddProperty("RINDEX", energyPLSTR_WLSfiber, rindexPLSTR_WLSfiber, 101);
   mptWLS_Core->AddProperty("WLSABSLENGTH", energyWLS_ABS, abslengthPLSTR_WLSfiber, 139/*energyWLS_ABS_Length*/);
   mptWLS_Core->AddProperty("WLSCOMPONENT", energyWLS_EMS, emissionWLSfiber, 128);
   mptWLS_Core->AddConstProperty("WLSTIMECONSTANT", 0.5*ns);
   mptWLS_Core->AddConstProperty("WLSMEANNUMBERPHOTONS", 1);


    WLS_Core->SetMaterialPropertiesTable(mptWLS_Core);


    G4MaterialPropertiesTable *mptPMMA = new G4MaterialPropertiesTable();

    mptPMMA->AddProperty("RINDEX", energyPMMArindex, rindexPMMA, 101);
    mptPMMA->AddProperty("ABSLENGTH", energyPMMA, abslengthPMMA, 100);
    
    PMMA->SetMaterialPropertiesTable(mptPMMA);


    worldMat->SetMaterialPropertiesTable(mptWorld);




    G4MaterialPropertiesTable *mptTiO2 = new G4MaterialPropertiesTable();

    mptTiO2->AddProperty("RINDEX", energyTiO2, rindexTiO2, 101);
    mptTiO2->AddProperty("ABSLENGTH", energyTiO2abs, abslengthTiO2, 101);
    
    TiO2->SetMaterialPropertiesTable(mptTiO2);





    G4MaterialPropertiesTable *mptPLSTR = new G4MaterialPropertiesTable();///////////////Spectru emisie scintilator/////////????

    mptPLSTR->AddProperty("RINDEX", energyPLSTR_WLSfiber, rindexPLSTR_WLSfiber, 101);
    mptPLSTR->AddProperty("ABSLENGTH", energyPLSTR, abslengthPLSTR, 33);
    mptPLSTR->AddProperty("FASTCOMPONENT", energyFastCompScin, fraction, 106,true);
    mptPLSTR->AddConstProperty("SCINTILLATIONYIELD",9744/MeV);        //////////change the number of optical photons produced for a deposited energy of 1 MeV///////////
    mptPLSTR->AddConstProperty("RESOLUTIONSCALE",0.0); //affects the fluctuations of the actual numberof photons produced at a step
    mptPLSTR->AddConstProperty("FASTTIMECONSTANT", 2.5*ns,true);
    mptPLSTR->AddConstProperty("YIELDRATIO",1.,true); //is redundant if Birk's constant is used
    //the yield ratio sets the ratio of yields between fast/slow components




    polystyrene->SetMaterialPropertiesTable(mptPLSTR);
}

//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......
G4VPhysicalVolume* DetectorConstruction::Construct()
{
  G4double R0, R1;

    R0 = 0.6875*mm;             // radius of the fiber core
    R1 = 0.0625*mm;             // radius of the fiber cladding
    
    G4double Lz, Ly, Lx;

    Lz = 50*cm;                 // scintillator cell halflength(OZ)
    Ly = 0.5*cm;                // scintillator cell halfheight(OY)
    Lx = 1.25*cm;               // scintillator cell haldwidth(OX)

    G4double Gx, Gy;

    Gx = 1.*mm;                  // groove halfwidth(OX)
    Gy = 1.*mm;                 // groove halfheight(OY)   

    G4double w = 0.5*mm;        // width of the paint layer  



    solidWorld = new G4Box("solidWorld", xWorld, yWorld, zWorld);

    logicWorld = new G4LogicalVolume(solidWorld, worldMat, "logicWorld");

    physWorld = new G4PVPlacement(0, G4ThreeVector(0., 0., 0.), logicWorld, "physWorld", 0, false, 0, true);



    solidCore = new G4Tubs("solidCore",0.*cm, R0 , 50.05*cm, 0.,2*M_PI);

    solidCladding = new G4Tubs("solidCladding",R0, R0+R1, 50.05*cm, 0.,2*M_PI);

    solidCapDet = new G4Box("solidCapDet",3*mm, 3*mm, 0.1*mm);

    logicCore = new G4LogicalVolume(solidCore, WLS_Core, "logicCore",0,0,0); //here we use WLS_Core(polystyrene with WLS properties)

    logicCladding = new G4LogicalVolume(solidCladding, PMMA, "logicCladding",0,0,0);

    logicCapDet = new G4LogicalVolume(solidCapDet, worldMat, "logicCapDet",0,0,0);

    /*solidCore = new G4Ellipsoid("solidCore",0.*cm, R0 , 50.05*cm, 0.,2*M_PI);

    solidCladding = new G4Ellipsoid("solidCladding",R0, R0+R1, 50.05*cm, 0.,2*M_PI);

    solidCapDet = new G4Box("solidCapDet",3*mm, 3*mm, 0.1*mm);

    logicCore = new G4LogicalVolume(solidCore, WLS_Core, "logicCore",0,0,0); //here we use WLS_Core(polystyrene with WLS properties)

    logicCladding = new G4LogicalVolume(solidCladding, PMMA, "logicCladding",0,0,0);

    logicCapDet = new G4LogicalVolume(solidCapDet, worldMat, "logicCapDet",0,0,0);*/





    physCore = new G4PVPlacement(0,G4ThreeVector(0.,Ly-1.*mm,0.*m),logicCore,"physCore",logicWorld,false,0,true);

    physCladding = new G4PVPlacement(0,G4ThreeVector(0.,Ly-1.*mm,0.*m),logicCladding,"physCladding",logicWorld,false,0,true);
 

    physCapDet1 = new G4PVPlacement(0,G4ThreeVector(0.*cm,Ly-1.*mm,50.06*cm), logicCapDet,"physCapDet1", logicWorld, true, 0, true);//the z component of the Vector can be changed to specify the distance

    physCapDet2 = new G4PVPlacement(0,G4ThreeVector(0.*cm,Ly-1.*mm,-50.06*cm), logicCapDet,"physCapDet2", logicWorld, true, 1, true);//between the end of the optical fiber and the SiPM

  //physCapDet1 = new G4PVPlacement(0,G4ThreeVector(0.*cm,Ly-1.*mm,48*cm), logicCapDet,"physCapDet1", logicWorld, true, 0, true);//the z component of the Vector can be changed to specify the distance

    //physCapDet2 = new G4PVPlacement(0,G4ThreeVector(0.*cm,Ly-1.*mm,-48*cm), logicCapDet,"physCapDet2", logicWorld, true, 1, true);//between the


    Scin_FullBox = new G4Box("Scin_FullBox", Lx , Ly , Lz);

    scintilator_groove_box = new G4Box("scintilator_groove_box", Gx, Gy, Lz+1.*mm);

    Scin_Box = new G4SubtractionSolid ("Scin_Box", Scin_FullBox, scintilator_groove_box, 0, G4ThreeVector(0, Ly-1*mm, 0));

    logicScin = new G4LogicalVolume(Scin_Box, polystyrene, "logicScin",0,0,0);

    physScin = new G4PVPlacement(0,G4ThreeVector(0.*cm,0.*cm,0.*m),logicScin,"physScin",logicWorld,false,0,true);



    TiO2Box = new G4Box("TiO2Box", Lx+w, Ly+w, Lz+w);

    TiO2_groove = new G4Box("TiO2_groove", Gx+0.1*mm, 0.1*mm+Gy+w/2, Lz+w+1*mm);

    TiO2cover = new G4SubtractionSolid("TiO2cover", TiO2Box, Scin_FullBox, 0, G4ThreeVector(0.*cm,0.*cm,0.*m));

    TiO2Box_with_groove = new G4SubtractionSolid("TiO2Box_with_groove", TiO2cover, TiO2_groove, 0, G4ThreeVector(0.*cm,Ly-0.75*mm,0.*m));

    TiO2_logic = new G4LogicalVolume(TiO2Box_with_groove, TiO2, "TiO2_logic",0,0,0);

    TiO2_phys = new G4PVPlacement(0,G4ThreeVector(0., 0., 0.), TiO2_logic, "TiO2_phys", logicWorld, false, 0, true);



    std::vector<G4double> energy = 

    {2.00*eV,2.03*eV,2.06*eV,2.09*eV,2.12*eV,
   2.15*eV,2.18*eV,2.21*eV,2.24*eV,2.27*eV,
   2.30*eV,2.33*eV,2.36*eV,2.39*eV,2.42*eV,
   2.45*eV,2.48*eV,2.51*eV,2.54*eV,2.57*eV,
   2.60*eV,2.63*eV,2.66*eV,2.69*eV,2.72*eV,
   2.75*eV,2.78*eV,2.81*eV,2.84*eV,2.87*eV,
   2.90*eV,2.93*eV,2.96*eV,2.99*eV,3.02*eV,
   3.05*eV,3.08*eV,3.11*eV,3.14*eV,3.17*eV,
   3.20*eV,3.23*eV,3.26*eV,3.29*eV,3.32*eV,
   3.35*eV,3.38*eV,3.41*eV,3.44*eV,3.47*eV};

   // STD_Vector_Sort(energy);


    std::vector<G4double> reflectivity = 

    { 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,1.0, 1.0, 1.0, 1.0,
    1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 
    1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 
    1.0, 1.0, 1.0, 1.0, 1.0, 1.0,1.0, 1.0, 1.0, 1.0, 
    1.0, 1.0, 1.0, 1.0, 1.0, 1.0,1.0, 1.0, 1.0, 1.0  };


    std::vector<G4double> efficiency   =     

      { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,0.0, 0.0, 0.0, 0.0,
     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
     0.0, 0.0, 0.0, 0.0, 0.0, 0.0,0.0, 0.0, 0.0, 0.0, 
     0.0, 0.0, 0.0, 0.0, 0.0, 0.0,0.0, 0.0, 0.0, 0.0  };


    std::vector<G4double> energyTiO2 =
    {
        1.97139479905437*eV,2.0782554517134*eV,2.12188295165394*eV,2.19736495388669*eV,2.30677731673582*eV,
        2.48184523809524*eV,2.62852639873916*eV,2.83639455782313*eV,3.00504504504504*eV,3.16771130104463*eV,
        3.30912698412698*eV,3.36929292929293*eV,3.46375908618899*eV,3.52973544973545*eV,3.5982740021575*eV,
        3.71861761426979*eV,3.79476678043231*eV,3.87409988385598*eV,3.99952038369305*eV,4.17994987468672*eV,
        4.48333333333333*eV,4.7313475177305*eV,4.94162962962963*eV,5.24465408805031*eV,5.42373983739837*eV,
        5.64399323181049*eV,5.79097222222222*eV,6.07577413479053*eV,6.24644194756554*eV,6.42697495183044*eV,
        6.73858585858586*eV,6.99287211740042*eV,7.12735042735043*eV,7.31491228070175*eV,7.36335540838852*eV,
        7.56371882086168*eV,7.7212962962963*eV,7.83004694835681*eV,8.11581508515815*eV,8.29751243781094*eV,
        8.61912144702842*eV,8.75485564304462*eV,8.89493333333333*eV,9.26555555555555*eV,9.5031339031339*eV,
        9.75321637426901*eV,9.83952802359882*eV,10.0168168168168*eV,10.391277258567*eV,10.6910256410256*eV,
        11.4625429553265*eV,11.4625429553265*eV,11.7038596491228*eV,11.9555555555556*eV,12.4928838951311*eV,
        12.6348484848485*eV,12.7800766283525*eV,13.0807843137255*eV,13.395983935743*eV,13.5593495934959*eV,
        13.8983333333333*eV
    };

//STD_Vector_Sort(energyTiO2);

    std::vector<G4double> reflectivityTiO2 =
    {
        0.996153846153846,0.993846153846154,0.993846153846154,0.996153846153846,0.998461538461538,
        0.998461538461538,0.998461538461538,1.00076923076923,0.998461538461538,0.993846153846154,
        0.961538461538462,0.887692307692308,0.686923076923077,0.306153846153846,0.082307692307692,
        0.11,0.089230769230769,0.063846153846154,0.052307692307692,0.077692307692308,
        0.153846153846154,0.186153846153846,0.158461538461538,0.112307692307692,0.130769230769231,
        0.23,0.301538461538462,0.331538461538462,0.308461538461538,0.239230769230769,
        0.105384615384615,0.135384615384615,0.216153846153846,0.326923076923077,0.308461538461538,
        0.165384615384615,0.29,0.405384615384615,0.359230769230769,0.227692307692308,
        0.403076923076923,0.310769230769231,0.086923076923077,0.008461538461538,0.036153846153846,
        0.128461538461538,0.23,0.317692307692308,0.317692307692308,0.179230769230769,
        0.114615384615385,0.26,0.370769230769231,0.465384615384615,0.391538461538461,
        0.493076923076923,0.585384615384615,0.781538461538462,0.610769230769231,0.296923076923077,
        0.082307692307692
    };

//STD_Vector_Sort(reflectivityTiO2);




    OpticalSurfaceCore = new G4OpticalSurface("OpticalSurfaceCore");


    OpticalSurfaceCore->SetType(dielectric_dielectric);
    OpticalSurfaceCore->SetFinish(polished);//another option is ground
    OpticalSurfaceCore->SetModel(unified); // another option is glisur

    G4MaterialPropertiesTable* Core_Skin = new G4MaterialPropertiesTable(); //Core fiber surface properties

    Core_Skin->AddProperty("REFLECTIVITY", energy, reflectivity);
    // Core_Skin->AddProperty("EFFICIENCY", energy, efficiency);

    OpticalSurfaceCore->SetMaterialPropertiesTable(Core_Skin);



    Core_Surface = new G4LogicalSkinSurface("Core_Surface", logicCore, OpticalSurfaceCore);

    Cladding_Surface = new G4LogicalSkinSurface("Cladding_Surface", logicCladding, OpticalSurfaceCore);

    Core_Cladding = new G4LogicalBorderSurface("Core_Cladding", physCore, physCladding, OpticalSurfaceCore);
    Cladding_Core = new G4LogicalBorderSurface("Cladding_Core", physCladding, physCore, OpticalSurfaceCore);

    Clad_World = new G4LogicalBorderSurface("Clad_World", physCladding, physWorld, OpticalSurfaceCore);
    World_Clad = new G4LogicalBorderSurface("World_Clad", physWorld, physCladding, OpticalSurfaceCore);





    OpticalSurfaceTiO2 = new G4OpticalSurface("OpticalSurfaceTiO2");


    OpticalSurfaceTiO2->SetType(dielectric_metal);
    OpticalSurfaceTiO2->SetFinish(ground);
    OpticalSurfaceTiO2->SetModel(unified);
    OpticalSurfaceTiO2->SetSigmaAlpha(0.3);  
    G4MaterialPropertiesTable* TiO2_Skin = new G4MaterialPropertiesTable(); //TiO2 layer surface properties

    TiO2_Skin->AddProperty("REFLECTIVITY", energyTiO2, reflectivityTiO2);
    // TiO2_Skin->AddProperty("EFFICIENCY", energy, efficiency);


    OpticalSurfaceTiO2->SetMaterialPropertiesTable(TiO2_Skin);

    TiO2_Scin = new G4LogicalBorderSurface("TiO2_Scin", physScin, TiO2_phys, OpticalSurfaceTiO2);
    Scin_TiO2 = new G4LogicalBorderSurface("Scin_TiO2", TiO2_phys, physScin, OpticalSurfaceTiO2);





    OpticalSurfaceScin = new G4OpticalSurface("OpticalSurfaceScin");


    OpticalSurfaceScin->SetType(dielectric_dielectric);
    OpticalSurfaceScin->SetFinish(ground);
    OpticalSurfaceScin->SetModel(unified);
    OpticalSurfaceScin->SetSigmaAlpha(0.3);

    G4MaterialPropertiesTable* Scin_Skin = new G4MaterialPropertiesTable(); //Scintil. surface properties

    Scin_Skin->AddProperty("REFLECTIVITY", energy, reflectivity);
    // Scin_Skin->AddProperty("EFFICIENCY", energy, efficiency);

    OpticalSurfaceScin->SetMaterialPropertiesTable(Scin_Skin);

    Scin_World = new G4LogicalBorderSurface("Scin_World", physScin, physWorld, OpticalSurfaceScin);
    World_Scin = new G4LogicalBorderSurface("World_Scin", physWorld, physScin, OpticalSurfaceScin);


    fScoringVolume = logicScin;

    return physWorld;
}



//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......


//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......

}  // namespace B4
